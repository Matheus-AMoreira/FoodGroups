@page "/usuarios/criar"
@using FoodGroups.DTOs
@using FoodGroups.Models 
@inject IUsuarioService UsuarioService
@inject NavigationManager Navigation

<h1>Criar Usu√°rio</h1>

<div class="form-container">
    <EditForm Model="@novoUsuario" OnValidSubmit="HandleValidSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-group">
            <label>Nome:</label>
            <InputText class="form-control" @bind-Value="novoUsuario.Nome" />
        </div>

        <div class="form-group">
            <label>Email:</label>
            <InputText class="form-control" @bind-Value="novoUsuario.Email" />
        </div>

        <div class="form-group">
            <label>Senha:</label>
            <InputText type="password" class="form-control" @bind-Value="novoUsuario.Senha" />
        </div>

        <button type="submit" class="btn btn-primary">Salvar</button>
        <a href="usuarios" class="btn btn-secondary">Cancelar</a>
    </EditForm>
</div>

@code {
    private CriarUsuarioDTO novoUsuario = new();

    private async Task HandleValidSubmit()
    {
        // Mapear DTO para Model (Manual ou usar AutoMapper se configurado)
        var usuarioModel = new Usuario 
        { 
            Nome = novoUsuario.Nome,
            Email = novoUsuario.Email,
            Senha = novoUsuario.Senha
        };

        await UsuarioService.CriarUsuario(usuarioModel);
        Navigation.NavigateTo("usuarios");
    }
}